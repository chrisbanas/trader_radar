!function(){"use strict";!function(){const e="8660568d82eaea759bb0ec8e463033d2";let t=d3.select("#treemapcanvas");async function a(t){const a=await fetch(`https://financialmodelingprep.com/api/v3/${t}_constituent?apikey=${e}`).then((e=>e.json())),s=a.map((e=>e.symbol)).join(","),n=await fetch(`https://financialmodelingprep.com/api/v3/quote/${s}?apikey=${e}`).then((e=>e.json())),i={};return a.forEach((e=>{i[e.symbol]={name:e.symbol,sector:e.sector,fullName:e.name,subSector:e.subSector,marketCap:n.find((t=>t.symbol===e.symbol)).marketCap,changesPercentage:n.find((t=>t.symbol===e.symbol)).changesPercentage,volume:n.find((t=>t.symbol===e.symbol)).volume,avgVolume:n.find((t=>t.symbol===e.symbol)).avgVolume,sharesOutstanding:n.find((t=>t.symbol===e.symbol)).sharesOutstanding,price:n.find((t=>t.symbol===e.symbol)).price,changeValue:n.find((t=>t.symbol===e.symbol)).change,dayLow:n.find((t=>t.symbol===e.symbol)).dayLow,dayHigh:n.find((t=>t.symbol===e.symbol)).dayHigh,yearHigh:n.find((t=>t.symbol===e.symbol)).yearHigh,yearLow:n.find((t=>t.symbol===e.symbol)).yearLow,priceAvg50:n.find((t=>t.symbol===e.symbol)).priceAvg50,priceAvg200:n.find((t=>t.symbol===e.symbol)).priceAvg200,open:n.find((t=>t.symbol===e.symbol)).open,previousClose:n.find((t=>t.symbol===e.symbol)).previousClose,eps:n.find((t=>t.symbol===e.symbol)).eps,pe:n.find((t=>t.symbol===e.symbol)).pe}})),Object.values(i)}function s(e){const t={name:"stock",children:[]},a={};return e.forEach((e=>{const t=e.sector;a[t]||(a[t]={name:t,children:[]}),a[t].children.push(e)})),Object.values(a).forEach((e=>{t.children.push(e)})),t}function n(e,t){d3.selectAll("g").remove(),i(e,t)}let i=(e,a)=>{let s=d3.hierarchy(e,(e=>e.children)).sum((e=>e[a])).sort(((e,t)=>t.value-e.value));d3.treemap().tile(d3.treemapBinary).size([t.node().clientWidth,t.node().clientHeight]).paddingOuter(7).paddingTop(43).paddingInner(2).round(!0)(s);let n=s.leaves(),i=d3.select("body").append("div").attr("class","details").style("display","none"),r=t.selectAll("g").data(n).enter().append("g").attr("transform",(e=>"translate("+e.x0+", "+e.y0+")")).each((function(e){d3.select(this).attr("data-original-transform",d3.select(this).attr("transform")),d3.select(this).attr("data-name",e.data.name),d3.select(this).attr("data-fullName",e.data.fullName),d3.select(this).attr("data-marketCap",e.data.marketCap.toLocaleString("en-US")),d3.select(this).attr("data-price",e.data.price.toFixed(2)),d3.select(this).attr("data-changeValue",e.data.changeValue.toFixed(2)),d3.select(this).attr("data-changesPercentage",e.data.changesPercentage.toFixed(2)),d3.select(this).attr("data-dayLow",e.data.dayLow.toFixed(2)),d3.select(this).attr("data-dayHigh",e.data.dayHigh.toFixed(2)),d3.select(this).attr("data-yearHigh",e.data.yearHigh.toFixed(2)),d3.select(this).attr("data-yearLow",e.data.yearLow.toFixed(2)),d3.select(this).attr("data-priceAvg50",e.data.priceAvg50.toFixed(2)),d3.select(this).attr("data-priceAvg200",e.data.priceAvg200.toFixed(2)),d3.select(this).attr("data-open",e.data.open.toFixed(2)),d3.select(this).attr("data-previousClose",e.data.previousClose.toFixed(2)),d3.select(this).attr("data-eps",e.data.eps.toFixed(2)),d3.select(this).attr("data-pe",e.data.pe.toFixed(2)),d3.select(this).attr("data-x0",e.x0+27),d3.select(this).attr("data-y0",e.y0+20),d3.select(this).attr("data-x0",e.x1+40),d3.select(this).attr("data-y0",e.y1);let t=(e.x1-e.x0)*(e.y1-e.y0),a=Math.sqrt(16e4/t);d3.select(this).attr("data-scale",a)})).on("mouseover",(function(e){i.html(`<strong>${d3.select(this).attr("data-fullName")}</strong>\n        <br>\n        <br>\n        Ticker: ${d3.select(this).attr("data-name")}\n        <br>\n        Market Cap: ${d3.select(this).attr("data-marketCap")}\n        <br>\n        Price: ${d3.select(this).attr("data-price")}\n        <br>\n        Change: ${d3.select(this).attr("data-changeValue")}\n        <br>\n        Change %: ${d3.select(this).attr("data-changesPercentage")}%\n        <br>\n        Low: ${d3.select(this).attr("data-dayLow")}\n        <br>\n        High: ${d3.select(this).attr("data-dayHigh")}\n        <br>\n        Open: ${d3.select(this).attr("data-open")}\n        <br>\n        Previous Close: ${d3.select(this).attr("data-previousClose")}\n        <br>\n        Yr High: ${d3.select(this).attr("data-yearHigh")}\n        <br>\n        Yr Low: ${d3.select(this).attr("data-yearLow")}\n        <br>\n        50 Day Avg: ${d3.select(this).attr("data-priceAvg50")}\n        <br>\n        200 Day Avg: ${d3.select(this).attr("data-priceAvg200")}\n        <br>\n        EPS: ${d3.select(this).attr("data-eps")}\n        <br>\n        PE: ${d3.select(this).attr("data-pe")}\n        `),i.style("display","block").style("padding","10px").style("background-color","#E2FFFF").style("border","1px solid #ccc").style("border-radius","5px").style("font-size","16px").style("font-family","'Roboto Slab', serif").style("font-weight","bold").style("box-shadow","0px 0px 5px rgba(0, 0, 0, 0.1)").style("left",d3.select(this).attr("data-x0")+"px").style("top",d3.select(this).attr("data-y0")+"px")})).on("mouseout",(function(){i.style("display","none"),d3.select(this).select(".hover-text").remove()})).on("click",(function(e){let t=d3.select(this).attr("data-original-transform"),a=d3.select(this).attr("data-scale"),s=d3.select(this).node();s.parentNode.appendChild(s),!1===d3.select(this).classed("selected")?(d3.select(this).select("rect").transition().duration(750).style("fill","orange"),d3.select(this).each((function(){const e=d3.select(this).select("rect");e.attr("data-original-fill",e.style("fill"))})).transition().duration(750).attr("transform",d3.zoomIdentity.translate(550,350).scale(a)),d3.select(this).classed("selected",!0)):(d3.select(this).select("rect").transition().duration(750).style("fill",(function(){return d3.select(this).attr("data-original-fill")})),d3.select(this).transition().duration(750).attr("transform",t),d3.select(this).classed("selected",!1))}));r.append("rect").attr("class","tile").attr("fill",(e=>e.data.changesPercentage<-3?"#f63538":e.data.changesPercentage<-2?"#bf4045":e.data.changesPercentage<-1||e.data.changesPercentage>-1&&e.data.changesPercentage<0?"#f77c80":e.data.changesPercentage<1?"#42bd7f":e.data.changesPercentage<2?"#2f9e4f":(e.data.changesPercentage,"#35764e"))).attr("data-name",(e=>e.data.name)).attr("data-sector",(e=>e.data.sector)).attr(`data-${a}`,(e=>e.data[a])).attr("width",(e=>e.x1-e.x0)).attr("height",(e=>e.y1-e.y0)),t.selectAll("text").remove(),t.selectAll("titles").data(s.children).enter().append("text").attr("class","title").attr("x",(e=>e.x0+7)).attr("y",(e=>e.y0+30)).text((function(e){return e.data.name})).attr("font-size","19px").style("fill","white"),r.append("text").text((e=>e.data.name)).attr("class","label").attr("x",(e=>(e.x1-e.x0)/3)).attr("y",(e=>(e.y1-e.y0)/2)).style("fill","white").attr("font-size",(e=>`${Math.min((e.x1-e.x0)/10,(e.y1-e.y0)/10)}px`)),r.append("text").text((e=>`${e.data.changesPercentage.toFixed(2)}%`)).attr("class","label").attr("x",(e=>(e.x1-e.x0)/3)).attr("y",(e=>(e.y1-e.y0)/2+(e.y1-e.y0)/12.5)).style("fill","white").attr("font-size",(e=>`${Math.min((e.x1-e.x0)/10,(e.y1-e.y0)/10)}px`)),r.append("image").attr("xlink:href",(e=>`https://financialmodelingprep.com/image-stock/${e.data.name}.png`)).attr("class","label").attr("x",(e=>(e.x1-e.x0)/3)).attr("y",(e=>(e.y1-e.y0)/2+(e.y1-e.y0)/12.5)).attr("width",(e=>(e.x1-e.x0)/3)).attr("height",(e=>(e.y1-e.y0)/3))};const r="8660568d82eaea759bb0ec8e463033d2";async function d(e){const t=await async function(e){const t=await fetch(`https://financialmodelingprep.com/api/v3/${e}_constituent?apikey=${r}`).then((e=>e.json())),a=t.map((e=>e.symbol)).join(","),s=await fetch(`https://financialmodelingprep.com/api/v3/quote/${a}?apikey=${r}`).then((e=>e.json())),n=t.map((e=>{const t=s.find((t=>t.symbol===e.symbol));return{symbol:e.symbol,changesPercentage:t?t.changesPercentage:null,price:t?t.price:null}}));return n.sort(((e,t)=>e.symbol.localeCompare(t.symbol))),n}(e),a=document.querySelector("#ticker");a.innerHTML="",t.forEach((e=>{const t=document.createElement("p");t.textContent=`${e.symbol}: ${e.price?e.price.toFixed(2):"N/A"}`,e.changesPercentage<0?t.classList.add("negative"):e.changesPercentage>=0&&t.classList.add("positive"),a.appendChild(t)})),setInterval((()=>{document.querySelector("#ticker").scrollLeft+=2}),100)}function o(){let e=new Date,t=e.toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",timeZone:"America/New_York"});t=t.replace(/([A-Z]+) Standard Time$/,"$1");let a=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),13,30,0)),s=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),20,0,0)),n=a-e,i="";n>0?i=Math.floor(n/1e3/60/60)+" hr "+Math.floor(n/1e3/60%60)+" min until open":e<s?(n=s-e,i=Math.floor(n/1e3/60/60)+" hr "+Math.floor(n/1e3/60%60)+" min until close"):i="Market is closed";let r=(new Date).toLocaleString("en-US",{timeZone:"America/New_York"}),d=new Date(r).getHours();d>=9&&d<16?(t+=" EST  |  "+i,document.getElementById("datetime").style.color="green"):(t+=" EST  |  "+i,document.getElementById("datetime").style.color="red"),document.getElementById("datetime").innerHTML=t}const l="8660568d82eaea759bb0ec8e463033d2",c=document.querySelector("#input");document.querySelector("#clear-button").addEventListener("click",(function(){c.value="",document.getElementById("search-results").style.display="none",document.getElementById("filters").style.display="flex",document.getElementById("description").style.display="flex",document.getElementById("treemapcanvas").style.display="flex"})),async function(){const e=document.getElementById("index"),t=document.getElementById("size-by"),r="sp500",d="marketCap";e.value=r,t.value=d;const o=s(await a(r));i(o,d),e.addEventListener("change",(async function(){const i=e.value,r=t.value;n(s(await a(i)),r)})),t.addEventListener("change",(async function(){const i=t.value,r=e.value;n(s(await a(r)),i)}))}(),async function(){const e=document.getElementById("index"),t="sp500";e.value=t,d(t),e.addEventListener("change",(async function(){d(e.value)}))}(),o(),setInterval(o,1e3),async function(){const e=document.getElementById("index"),t=document.getElementById("size-by"),a=document.getElementById("description");function s(){const s=e.value,n=t.value;return a.innerText="sp500"===s&&"marketCap"===n?"S&P 500 index stocks categorized by industries. Size represents market cap.":"sp500"===s&&"volume"===n?"S&P 500 index stocks categorized by industries. Size represents volume.":"sp500"===s&&"avgVolume"===n?"S&P 500 index stocks categorized by industries. Size represents average volume.":"sp500"===s&&"sharesOutstanding"===n?"S&P 500 index stocks categorized by industries. Size represents shares outstanding.":"dowjones"===s&&"marketCap"===n?"Dow Jones index stocks categorized by industries. Size represents market cap.":"dowjones"===s&&"volume"===n?"Dow Jones index stocks categorized by industries. Size represents volume.":"dowjones"===s&&"avgVolume"===n?"Dow Jones index stocks categorized by industries. Size represents average volume.":"dowjones"===s&&"sharesOutstanding"===n?"Dow Jones index stocks categorized by industries. Size represents shares outstanding.":"nasdaq"===s&&"marketCap"===n?"NASDAQ index stocks categorized by industries. Size represents market cap.":"nasdaq"===s&&"volume"===n?"NASDAQ index stocks categorized by industries. Size represents volume.":"nasdaq"===s&&"avgVolume"===n?"NASDAQ index stocks categorized by industries. Size represents average volume.":"nasdaq"===s&&"sharesOutstanding"===n?"NASDAQ index stocks categorized by industries. Size represents shares outstanding.":`${s} index stocks categorized by industries. Size represents ${n}.`}function n(){const s=t.value,n=e.value;return a.innerText="sp500"===n&&"marketCap"===s?"S&P 500 index stocks categorized by industries. Size represents market cap.":"sp500"===n&&"volume"===s?"S&P 500 index stocks categorized by industries. Size represents volume.":"sp500"===n&&"avgVolume"===s?"S&P 500 index stocks categorized by industries. Size represents average volume.":"sp500"===n&&"sharesOutstanding"===s?"S&P 500 index stocks categorized by industries. Size represents shares outstanding.":"dowjones"===n&&"marketCap"===s?"Dow Jones index stocks categorized by industries. Size represents market cap.":"dowjones"===n&&"volume"===s?"Dow Jones index stocks categorized by industries. Size represents volume.":"dowjones"===n&&"avgVolume"===s?"Dow Jones index stocks categorized by industries. Size represents average volume.":"dowjones"===n&&"sharesOutstanding"===s?"Dow Jones index stocks categorized by industries. Size represents shares outstanding.":"nasdaq"===n&&"marketCap"===s?"NASDAQ index stocks categorized by industries. Size represents market cap.":"nasdaq"===n&&"volume"===s?"NASDAQ index stocks categorized by industries. Size represents volume.":"nasdaq"===n&&"avgVolume"===s?"NASDAQ index stocks categorized by industries. Size represents average volume.":"nasdaq"===n&&"sharesOutstanding"===s?"NASDAQ index stocks categorized by industries. Size represents shares outstanding.":`${n} index stocks categorized by industries. Size represents ${s}.`}e.value="sp500",t.value="marketCap",s(),n(),e.addEventListener("change",s),t.addEventListener("change",n)}(),document.getElementById("search").addEventListener("click",(function(e){!async function(e){e.preventDefault();const t=document.getElementById("input").value,a=await async function(e){const t=`https://financialmodelingprep.com/api/v3/profile/${e}?apikey=${l}`;return await fetch(t).then((e=>e.json())).then((e=>{const t=JSON.stringify(e);return JSON.parse(t)})).catch((e=>(console.error(e),e)))}(t),s=(await async function(e){const t=`https://financialmodelingprep.com/api/v3/stock_news?tickers=${e}&apikey=${l}`;return await fetch(t).then((e=>e.json())).then((e=>{const t=JSON.stringify(e);return JSON.parse(t)})).catch((e=>(console.error(e),e)))}(t)).slice(0,5),n=document.getElementById("candle-chart"),i=await async function(e){const t=`https://financialmodelingprep.com/api/v3/historical-price-full/${e}?timeseries=180&apikey=${l}`;return await fetch(t).then((e=>e.json())).then((e=>{const t=JSON.stringify(e);return JSON.parse(t)})).catch((e=>(console.error(e),e)))}(t);n&&n.remove(),function(e){const t=65,a=20,s=90,n=100,i=1500-n-a,r=500-t-s,d=d3.scaleBand().range([0,i]).padding(.2),o=d3.scaleLinear().range([r,0]),l=d3.select("body").append("svg").attr("id","candle-chart").attr("width",i+n+a).attr("height",r+t+s).style("background-color","#f5f5f5").append("g").attr("transform","translate("+n+","+t+")");l.append("g").attr("class","grid").call(d3.axisLeft(o).tickSize(-i).tickFormat("")),l.append("g").attr("class","grid").attr("transform","translate(0,"+r+")").call(d3.axisBottom(d).tickSize(-r).tickFormat("")),e.forEach((function(e){e.date=`${new Date(e.date).getMonth()+1}/${new Date(e.date).getDate()}`,e.open=+e.open,e.high=+e.high,e.low=+e.low,e.close=+e.close})),e.reverse(),d.domain(e.map((function(e){return e.date}))),o.domain([d3.min(e,(function(e){return e.low})),d3.max(e,(function(e){return e.high}))]),l.append("g").attr("transform","translate(0,"+r+")").call(d3.axisBottom(d).tickValues(d.domain().filter((function(e,t){return t%30==0})))).selectAll("text").attr("transform","rotate(-90)").attr("x",-9).attr("y",0).style("text-anchor","end"),l.append("text").attr("class","x-axis-label").attr("x",i/2).attr("y",r+s/2).style("text-anchor","middle").text("Date"),l.append("g").call(d3.axisLeft(o)),l.append("text").attr("class","y-axis-label").attr("x",-r/2).attr("y",-n/2).attr("transform","rotate(-90)").style("text-anchor","middle").text("Price"),l.selectAll("rect").data(e).enter().append("rect").attr("x",(function(e){return d(e.date)})).attr("y",(function(e){return o(Math.max(e.open,e.close))})).attr("width",d.bandwidth()).attr("height",(function(e){return o(Math.min(e.open,e.close))-o(Math.max(e.open,e.close))})).attr("fill",(function(e){return e.open>e.close?"red":"green"})),l.append("text").attr("class","chart-subtitle").attr("x",i/2).attr("y",-t/2+25).style("text-anchor","middle").style("font-size","16px").text("Day Stock Prices")}(i.historical),document.getElementById("filters").style.display="none",document.getElementById("description").style.display="none",document.getElementById("treemapcanvas").style.display="none",document.getElementById("search-results").style.display="flex";const r=document.getElementById("search-results");if(r.innerHTML="",0===a.length)r.innerHTML="<p class='no-results'>No results found.</p>";else{const e=document.createElement("ul");e.classList.add("results-list");const t=document.createElement("li");t.classList.add("result-item");const n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.padding="20px";const d=document.createElement("img");d.style.marginRight="30px";const o=document.createElement("a");o.style.fontSize="20px",o.style.fontFamily="'Roboto Slab', serif",o.style.fontWeight="bold",o.style.marginRight="2px",n.classList.add("logo-and-name"),d.src=a[0].image,d.classList.add("logo"),o.href=a[0].website,o.textContent=a[0].companyName,o.classList.add("name"),n.appendChild(d),n.appendChild(o),t.appendChild(n);const l=document.createElement("div"),c=a[0].price-i.historical[0].open;l.textContent="$"+a[0].price,l.classList.add("price"),c<0?l.style.color="red":c>=0&&(l.style.color="green"),t.appendChild(l),e.appendChild(t);const p=document.createElement("ul");p.style.fontFamily="'Roboto Slab', serif",p.style.fontWeight="bold",p.style.display="flex",p.style.alignItems="center",p.style.justifyContent="space-between",p.style.fontSize="15px",p.style.padding="20px",p.style.paddingRight="30px",p.style.paddingLeft="30px",p.classList.add("news-list");for(const e of s){const t=document.createElement("li");t.classList.add("news-item");const a=document.createElement("a");a.href=e.url,a.textContent=e.title,a.classList.add("news-title");const s=document.createElement("p");s.textContent=e.text,s.classList.add("news-summary");const n=document.createElement("p");n.textContent=e.publishedDate.slice(0,10),n.classList.add("news-date"),t.appendChild(a),t.appendChild(s),t.appendChild(n),p.appendChild(t)}t.appendChild(p),e.appendChild(t),r.appendChild(e)}}(e)}))}()}();
//# sourceMappingURL=main.js.map